---
layout: post
title: "Django (1)"
description: ""
date: 2019-04-15
tags: []
category: Django
comments: true
share: true
---

## Django application 작성 예제 (myapp)
App 이란? 실제 client와 web-server 사이에 정보를 주고 받기 위한 웹 응용 프로그램
<br>

#### 0. project 생성 
note: 웹서버를 실행하기 위해 장고의 기본 테이블을 생성해야 함. 장고가 settings.py에 내부적으로 이미 설정해 놓은 기본 테이블 생성 (python에 내장되어있는 sqlite3를 사용)

```
(base) C:\njikim\Django django-admin startproject myproj1       // 프젝 생성
(venv) C:\njikim\Django>cd myproj1
(venv) C:\njikim\Django\myproj1>python manage.py makemigrations // migrate 준비작업
(venv) C:\njikim\Django\myproj1>python manage.py migrate        // settings.py 파일을 base로 최신 table 생성됨
(venv) C:\njikim\Django\myproj1>python manage.py runserver      // web server 시작(기본 port 번호: 8000)
```

#### 1. app 생성
```
(base) C:\njikim\Django\myproj1>python manage.py startapp myapp
```
```python
# myproj1 -> settings.py
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'myapp',    # INSTALLED_APPS에 myapp 추가
]
```
#### 2. client의 요청 처리
```python
# myproj1 -> myapp -> views.py
from django.http.response import HttpResponse

def index()     # 사용자가 접속 시 (요청 시) 함수 호출됨
    
```

#### 3. 메인 urls.py
사용자가 '처음' 접속하면 views.py에서 index라는 함수가 실행 되게 경로를 설정
```python
# myproj1 -> urls.py
from django.urls.conf import include
from myapp import views

urlpatterns = [
    path('admin/', admin.site.urls),
    
    # myapp 접속 경로
    path('', include('myapp.urls')),    # 접속시 첫 화면 url path 추가. include: 접속 경로 toss
]
```

#### 4. myapp urls.py
```python
# myapp -> urls.py 생성
from django.urls import path
from myapp import views

path('', views.index, name='index'), # 사용자 접속 시 views.index를 실행해라
```

#### 5. templates
```python
# myapp -> templates 폴더 생성 (장고 default명 임)
#    hello.html 작성

# myapp -> views.py
def hello_template(request):
    name = '은지'
    return render(request, 'hello.html', {'name':name})

# myapp -> urls.py
path('hello_tem', views.hello_template)     #hello_tem 접속 시 views.hello_template를 실행해라
```

#### 6. image 출력
```python
# myapp -> static images 폴더 생성 & 이미지 추가

# myapp -> templates
#    my.html 작성

# myapp -> views.py
    def hello_images

# myapp -> urls.py
    path('img', views.hello_images)
```
<br>

## 요청방식
1. get
 - 하이퍼링크 요청 방식, url 요청 방식
 - 기본 요청 방식
 - 간단한 데이터만 전송 (패킷의 header 부분에 데이터를 담아 전송)
 - 데이터 노출 (주소에 그대로)
 - 조회 요청시 사용
    
2. post
 - 폼 전송(=요청) 방식
 - 많은 양의 데이터 전송 (패킷의 body 부분에 데이터를 따로 보관해 전송)
 - 데이터 전송 시 노출되지 않음
 - 데이터 변경이나 등록 요청시
<br>

### get 방식 실습 (getapp)
```
(base) C:\njikim\Django\myproj1>python manage.py startapp getapp
```
```python
# myproj1 -> settings.py INSTALLED_APPS에 getapp 추가

# getapp -> templates 폴더 생성

# myproj1 -> urls.py
path('getapp/')

# getapp -> views.py
mainFunc()

# getapp -> templates -> index.html 작성
# 데이터 전송 by href="callget?name=eunjikim&age=20" & using form tag

# myproj1 -> urls.py
from getapp import views
path('getapp/', views.mainFunc)     # 메인 url에서 바로 처리 
```

note: 
- 그전에는 include로 접속 경로를 지정. 지금은 views에 있는 함수 바로 불러옴
- 메인에서 views로 직접 처리하는 건 하나만 할 수 있음
- http://127.0.0.1:8000/getapp/ 이런식으로 직접 url을 쳐서 요청하는 방식이 바로 get 방식
- http://127.0.0.1:8000/getapp?age=30    # get 방식으로 데이터도 같이 전송하는 예시
  
<br>

#### callget.html
getapp에서 href 클릭 했을 때 이동할 html

```python
# getapp -> views.py
from django.views.generic.base import TemplateView
class callView(TemplateView):   # TemplateView라는 django의 내장 class를 상속 받음

# myproj1 -> urls.py
from getapp.views import CallView
path('getapp/callget/', CallView.as_view())
```
<br>

#### insert.html 
callget.html에서 href 클릭 했을 때 이동할 html 
```python
# myproj1 -> urls.py
path('getapp/', include('getapp.urls'))
    
# getapp -> views.py    
def insertFunc()

# getapp -> urls.py 생성
from django.urls import path
from getapp import views

path('insert', views.insertFunc) 
```