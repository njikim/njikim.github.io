---
layout: post
title: "Django (4)"
description: "내장 db 연동"
date: 2019-04-16
tags: []
category: Django
comments: true
share: true
---

## 내장 db연동 예제: dbapp
- dbapp 생성, settings.py에 dbapp 추가

- templates -> articlelist.html 
```html
<body>
    <h2>자료 리스트</h2>
</body>
```

#### http://127.0.0.1:8000/dbapp/show 

- myproj1 -> urls.py 
```python
path('dbapp/', include('dbapp.urls')),
```

- dbapp -> urls.py 생성 
```python
from django.urls import path
from dbapp import views

urlpatterns = [
    path('show', views.mainFunc),
]
```

- dbapp -> views.py  
```python
from django.shortcuts import render

def mainFunc(request):
    return render(request, 'articlelist.html')
```

#### table 생성

- dbapp -> models.py     
```python
class Article(models.Model):
```

- makemigrations & migrate   
```
(base) C:\njikim\Django\myproj1>python manage.py makemigrations
(base) C:\njikim\Django\myproj1>python manage.py migrate
```

- 슈퍼유저 생성 
```
(base) C:\njikim\Django\myproj1>python manage.py createsuperuser
Username (leave blank to use 'acorn'): admin
Email address:
Password: abcd1234
```

- dbapp -> admin.py 
```python
# Article class 등록
from dbapp.models import Article
admin.site.register(Article)
```

- http://127.0.0.1/admin 페이지에 들어가보면 Article 테이블 생성된 것을 확인할 수 있음 <br>

- dbapp -> admin.py  
```python
class ArticleAdmin(admin.ModelAdmin):
    list_display = ('id', 'code', 'name', 'price', 'pub_date')

admin.site.register(Article, ArticleAdmin)
```

- 이제 admin 페이지에 들어가서 레코드 추가해보기

#### articlelist.html에 db에 있는 자료 보여주기
- dbapp -> views.py 
```python
from dbapp.models import Article
def mainFunc(request):
    return render(request, 'articlelist.html', {'articles': Article.objects.all()})
```

- dbapp -> templates -> articlelist.html 
```html
<body>
    <h2>자료 리스트</h2>
    {% if articles.count > 0 %}
        {% for i in articles %}
            <b>{{i.code}}</b> {{i.name}} {{i.price}} {{i.pub_date}} <br>
        {% endfor %}
    {% else %}
        <p>자료가 없네요</p>
    {% endif %}
</body>
```

- dbapp -> templates -> layout.html 추가 
```html
<body>
    <h2> 자료보기 </h2>
    <div style="color:salmon">
    {% block content %}
    {% endblock %}
    </div>
</body>
```