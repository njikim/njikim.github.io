---
layout: post
title: "SQL (3)"
description: "Join"
date: 2019-03-29
tags: [SQL]
category: SQL
comments: true
share: true
---

## 6. JOIN
 - 여러 개의 테이블을 병합하여 하나의 결과를 도출하기 위한 방법
 - 종류
	- Cartesian Product Join (데카르트 곱)
	- Equi Join: 공통 필드의 레코드를 가져오는 방법 (중복)
		- INNER JOIN (중복 제거)
	- OUTER JOIN: INNER JOIN 확장 (INNER JOIN + 공통되지 않은 레코드도 가져옴)
		- LEFT OUTER JOIN
		- RIGHT OUTER JOIN
		- FULL OUTER JOIN


<br>

```sql
USE dbexample;
CREATE TABLE tableA( 
	id	int	null,
    value	int	null
);

CREATE TABLE tableB( 
	id	int	null,
    value	int	null
);

INSERT INTO tableA VALUES(1, 10); 
INSERT INTO tableA VALUES(2, 20); 
INSERT INTO tableA VALUES(3, 30); 
INSERT INTO tableA VALUES(5, 50); 
INSERT INTO tableA VALUES(7, 70); 

INSERT INTO tableB VALUES(1, 10); 
INSERT INTO tableB VALUES(2, 20); 
INSERT INTO tableB VALUES(4, 40); 
INSERT INTO tableB VALUES(5, 50); 
INSERT INTO tableB VALUES(8, 80); 
```
### inner join
```sql
SELECT tableA.id, tableA.value FROM tableA INNER JOIN tableB 
	ON tableA.id = tableB.id; 

-- 별명 주기! 
-- note: 별명주면 별명만 사용해야 함, table 별명 as 사용 불가
SELECT a.id, a.value FROM tableA a INNER JOIN tableB b 
	ON a.id = b.id; 

-- mysql 자체 문법
SELECT a.id, a.value FROM tableA a, tableB b 
	 WHERE a.id = b.id; ```

```sql
-- 직원의 사번, 이름, 업무, 부서번호, 부서명을 조회
SELECT empno, ename, job, scott_emp.deptno, dname 
	FROM scott_emp INNER JOIN scott_dept 
	ON scott_emp.deptno = scott_dept.deptno;

+-------+--------+-----------+--------+------------+
| empno | ename  | job       | deptno | dname      |
+-------+--------+-----------+--------+------------+
|  7782 | CLARK  | MANAGER   |     10 | ACCOUNTING |
|  7839 | KING   | PRESIDENT |     10 | ACCOUNTING |
|  7934 | MILLER | CLERK     |     10 | ACCOUNTING |
|  7369 | SMITH  | CLERK     |     20 | RESEARCH   |
|  7566 | JONES  | MANAGER   |     20 | RESEARCH   |
|  7788 | SCOTT  | ANALYST   |     20 | RESEARCH   |
|  7876 | ADAMS  | CLERK     |     20 | RESEARCH   |
|  7902 | FORD   | ANALYST   |     20 | RESEARCH   |
|  7499 | ALLEN  | SALESMAN  |     30 | SALES      |
|  7521 | WARD   | SALESMAN  |     30 | SALES      |
|  7654 | MARTIN | SALESMAN  |     30 | SALES      |
|  7698 | BLAKE  | MANAGER   |     30 | SALES      |
|  7844 | TURNER | SALESMAN  |     30 | SALES      |
|  7900 | JAMES  | CLERK     |     30 | SALES      |
+-------+--------+-----------+--------+------------+

-- salesman에 대해서 직원의 사번, 이름, 업무, 부서번호, 부서명을 조회
-- ! 조건을 조인하면서 같이줄 때
SELECT empno, ename, job, emp.deptno, dname 
	FROM scott_emp emp INNER JOIN scott_dept dept 
	ON emp.deptno = dept.deptno AND job = 'salesman';

-- ! 조건을 조인 하고 나서 뒤에 줄 때
SELECT empno, ename, job, emp.deptno, dname 
	FROM scott_emp emp INNER JOIN scott_dept dept 
	ON emp.deptno = dept.deptno 
	WHERE job = 'salesman';

+-------+--------+----------+--------+-------+
| empno | ename  | job      | deptno | dname |
+-------+--------+----------+--------+-------+
|  7499 | ALLEN  | SALESMAN |     30 | SALES |
|  7521 | WARD   | SALESMAN |     30 | SALES |
|  7654 | MARTIN | SALESMAN |     30 | SALES |
|  7844 | TURNER | SALESMAN |     30 | SALES |
+-------+--------+----------+--------+-------+

-- New york에서 근무하는 직원의 이름, 업무, 부서명 조회
SELECT ename, job, scott_dept.dname 
	FROM scott_dept INNER JOIN scott_emp 
	on scott_emp.deptno = scott_dept.deptno 
	where loc="NEW YORK";
+--------+-----------+------------+
| ename  | job       | dname      |
+--------+-----------+------------+
| CLARK  | MANAGER   | ACCOUNTING |
| KING   | PRESIDENT | ACCOUNTING |
| MILLER | CLERK     | ACCOUNTING |
+--------+-----------+------------+
```
### outer join
```sql
SELECT a.id, a.value FROM tableA a LEFT OUTER JOIN tableB b 
	ON a.id = b.id;

    +------+-------+
    | id   | value |
    +------+-------+
    |    1 |    10 |
    |    2 |    20 |
    |    5 |    50 |
    |    3 |    30 |
    |    7 |    70 |
    +------+-------+
```